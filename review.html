<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Leave a review</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <style>
    :root { --bg:#f7f7f8; --card:#fff; --text:#222; --muted:#666; --ok:#0a7d27 }
    @media (prefers-color-scheme: dark){
      :root { --bg:#0b0b0c; --card:#151518; --text:#f3f3f4; --muted:#c6c6c9 }
    }
    html,body{height:100%}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;margin:0;background:var(--bg);display:grid;place-items:center}
    .card{max-width:640px;width:100%;background:var(--card);border:1px solid rgba(0,0,0,.08);border-radius:18px;box-shadow:0 8px 28px rgba(0,0,0,.08);padding:1.25rem}
    h1{margin:.2rem 0 .4rem 0;font-size:1.25rem;color:var(--text)}
    p{margin:.4rem 0;color:var(--muted);line-height:1.4}
    .strong{color:var(--text);font-weight:600}
    .ok{color:var(--ok);font-weight:700}
    .steps{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.5rem}
    .chip{border:1px dashed rgba(0,0,0,.18);padding:.4rem .6rem;border-radius:999px;font-size:.9rem;color:var(--muted)}
    .btn{display:inline-block;margin-top:.8rem;border:0;background:#111;color:#fff;padding:.8rem 1rem;border-radius:12px;font-weight:700;cursor:pointer}
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="card">
    <h1>Thanks for reviewing Oasis Bar &amp; Terrace ðŸ’›</h1>
    <p id="status">Getting things readyâ€¦</p>
    <div class="steps">
      <div class="chip">1) We copy your text</div>
      <div class="chip">2) We open Google</div>
      <div class="chip">3) <span class="strong">Tap the box â†’ Paste</span></div>
      <div class="chip">4) Choose stars â†’ Submit</div>
    </div>
    <button id="openBtn" class="btn hidden">Open Google review form</button>
  </div>

  <script>
    // âœ… Your direct write-a-review link (opens the dialog immediately)
    const REVIEW_URL = "https://search.google.com/local/writereview?placeid=ChIJmazmXKEDdkgR3hgEtNS3-hY";

    // Fallback (only used if something blocks the above)
    const FALLBACK_URL = "https://www.google.com/maps/place/Oasis+Bar+%26+Terrace/";

    const params = new URLSearchParams(location.search);
    const staff = (params.get("staff") || "your team").trim();

    // Keep this short so iOS/Android shows the paste chip clearly
    const template = `I was served by ${staff} and had a great experience at Oasis Bar & Terrace. Thank you!`;

    const status = document.getElementById("status");
    const btn = document.getElementById("openBtn");

    async function run() {
      try {
        // 1) Copy first so mobile shows the Paste suggestion
        if (navigator.clipboard?.writeText) {
          await navigator.clipboard.writeText(template);
          status.innerHTML = `Review text copied for <span class="ok">${staff}</span>.`;
        } else {
          status.textContent = `Copy this text, then tap the button: "${template}"`;
          btn.classList.remove("hidden");
          return;
        }

        // 2) Brief pause helps iOS/Android surface the paste UI
        await new Promise(r => setTimeout(r, 800));

        // 3) Open Google review dialog (same-tab to avoid popup blockers)
        status.innerHTML += ` Opening Google nowâ€¦`;
        location.href = REVIEW_URL;
      } catch (e) {
        status.textContent = `Copy this text, then tap the button: "${template}"`;
        btn.classList.remove("hidden");
      }
    }

    btn.addEventListener("click", () => {
      if (navigator.clipboard?.writeText) navigator.clipboard.writeText(template);
      location.href = REVIEW_URL || FALLBACK_URL;
    });

    run();
  </script>
</body>
</html>
